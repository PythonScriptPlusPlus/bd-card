<template>
    <div>
        <h1 class="wishes__title">–ü–æ–∂–µ–ª–∞–Ω–∏—è</h1>
        <h2 class="wishes__subtitle">–û—Ç –¥—Ä—É–∑–µ–π –∏ –±–ª–∏–∑–∫–∏—Ö</h2>
        <div class="wishes">
            <div
                v-for="wish in wishes"
                :key="wish.from"
                class="wishes__wrapper"
                :data-from="wish.from"
            >
                <div v-if="wish.from === 'VASSSSS'">
                  <canvas ref="confettiCanvas" class="wishes__canvas"></canvas>
                  <h3 class="wishes__from">–û—Ç: {{ wish.from }}</h3>
                  <p class="wishes__message">{{ wish.message }}</p>
                  <component v-if="wish.component" :is="wish.component" />
                </div>
                <div v-else>
                  <h3 class="wishes__from">–û—Ç: {{ wish.from }}</h3>
                  <p class="wishes__message">{{ wish.message }}</p>
                  <component v-if="wish.component" :is="wish.component" />
                </div>
            </div>
        </div>
    </div>
</template>

<script>
import confetti from 'canvas-confetti';
import ArishaComponent from './people/ArishaComponent.vue';
import UlyaComponent from './people/UlyaComponent.vue';
import VasComponent from './people/VasComponent.vue';

export default {
  components: {
    ArishaComponent,
    UlyaComponent,
    VasComponent,
  },
  data() {
    return {
      wishes: [
        {
          from: 'Georgie',
          message: '–° –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è –ê–ª–∏—Å! 20 –ª–µ—Ç - —ç—Ç–æ –≤–æ–æ–±—â–µ —É–∂–∞—Å –∫–∞–∫ –∫—Ä—É—Ç–æ. –¶–µ–∑–∞—Ä—å —Å—Ç–∞–ª —Å–µ–Ω–∞—Ç–æ—Ä–æ–º –≤ 20, Beatles –≤—ã–ø—É—Å—Ç–∏–ª–∏ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –º–µ–≥–∞ —É—Å–ø–µ—à–Ω—ã–π –∞–ª—å–±–æ–º - –ª—é–¥–∏ –¥–µ–ª–∞—é—Ç –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–µ –¥–µ–ª–∞ –∫–æ–≥–¥–∞ –∏–º 20, –∏ —è –æ—á–µ–Ω—å —Ä–∞–¥, —á—Ç–æ –º–Ω–µ —É–¥–∞—Å—Ç—Å—è —É–≤–∏–¥–µ—Ç—å –∫–∞–∫–∏–µ –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ç—ã —Å–¥–µ–ª–∞–µ—à—å –∑–∞ —ç—Ç–æ—Ç –≥–æ–¥! –ê —Ç—ã –∏—Ö —Ç–æ—á–Ω–æ —Å–¥–µ–ª–∞–µ—à—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–≥–¥–∞ –≤–æ–æ–±—â–µ —Ç—ã –Ω–µ –¥–æ—Å—Ç–∏–≥–∞–ª–∞ –≤—ã—Å–æ—Ç?',
        },
        {
          from: 'VASSSSS',
          message: '–≤—Å–µ —Ç–∞–∫–∂–µ –±–µ–∑ —É–º–∞ –æ—Ç —Ç–µ–±—è, –ª—é–±–∏–º–∫–∞, –∫–∞–∫ –∏ –≤ –Ω–∞—à—É –ø–µ—Ä–≤—É—é –≤—Å—Ç—Ä–µ—á—É!!!!! –æ—á–µ–Ω—å —Å–∫—É—á–∞—é –ø–æ —Ç–µ–±–µ –∏ –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ —Ç–≤–æ—è –∂–∏–∑–Ω—å –±—É–¥–µ—Ç –∫–∞–∫ –Ω–∞—à —ç–ø–∏–∫ –¥–µ—Ç—Å–∞–¥–æ–≤—Å–∫–∏–π —É—Ç—Ä–µ–Ω–Ω–∏–∫ü´µü´µ —è –ø—Ä–æ–≤–µ—Ä—é',
        },
        {
          from: '–ö–∞—Ç–∏ –∫—Ä–µ–∫–µ—Ä',
          message: '–ñ–µ–ª–∞—é —á—Ç–æ –±—ã –≥–æ—Ä–∏–∑–æ–Ω—Ç—ã –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –±—ã–ª–∏ –≤—Å–µ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç—ã –¥–ª—è —Ç–µ–±—è, —á—Ç–æ –±—ã —Ç–≤–æ–∏ —Å—Ç—Ä–∞—Ö–∏ –∏ –æ–±–∏–¥—ã –æ—Å—Ç–∞–ª–∏—Å—å –≤ –ø—Ä–æ—à–ª–æ–º, –∂–∏–≤–∏ —Ç–∞–∫ –∫–∞–∫ —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–±–µ —Å–µ—Ä–¥—Ü–µ ‚ô•Ô∏è',
        },
        {
          from: '–ü–æ–ª–∏–Ω–∫–∞ (–ü–æ)',
          message: '–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Ç–µ–±—è —Å –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è!!!! –¢—ã —Å—É–ø–µ—Ä –∫—Ä—É—Ç–∞—è!!! –Ø –æ—á–µ–Ω—å —Ä–∞–¥–∞ —á—Ç–æ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞ –∂–∏–∑–Ω–∏ —Ç–∞–∫ —Å–ª–æ–∂–∏—Å—å –∏ —É –º–µ–Ω—è –ø–æ—è–≤–∏–ª—Å—è –ø—Ä–∏–º–µ—Ä —Ç–∞–∫–æ–≥–æ —Å–≤–µ—Ç–ª–æ–≥–æ, –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–≥–æ –∏ —Å–∏–ª—å–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –∫–∞–∫ —Ç—ã!!! –Ø –∂–µ–ª–∞—é —Ç–µ–±–µ, —á—Ç–æ–±—ã –Ω–µ–≤–∑–≥–æ–¥—ã –æ–±—Ö–æ–¥–∏–ª–∏ —Ç–µ–±—è —Å—Ç–æ—Ä–æ–Ω–æ–π, –∫—Ä–µ–ø–∫–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è, —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏—è –∏ –ø–æ–±–æ–ª—å—à–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π!!!!',
        },
        {
          from: '—É–ª—è —à—É—Ç–∏–ª–∞',
          message: '–∂–µ–ª–∞—é —Ñ–æ–Ω—Ç–∞–Ω—ã —Ñ–∞–Ω—Ç—ã –∏ —Ä–µ–∫–∏ –∫–æ–∫–∞-–∫–æ–ª—ã, –º–æ—Ä–µ —Ö–∞–π–ø–∞ –∏ –≥–æ—Ä—ã —Ä–æ—Ñ–ª–∞, –Ω—É –∏ —Ü–µ–ª—ã–π —Å–∞–º–æ–ª—ë—Ç —Å–≤–µ–≥–∞!!!!!',
          component: 'UlyaComponent',
        },
        {
          from: '–ò—Ä–∏–Ω–∞ –Ω–∞–ø–æ–ª–µ–æ–Ω –∏–º–ø–µ—Ä–∞—Ç–æ—Ä –∑–∞–≤–æ–µ–≤–∞—Ç–µ–ª—å —à–∫–æ–¥–Ω–∏–∫',
          message: '–ú–æ—è –º–∏–ª–∞—è –ê–ª–∏—Å, –ª—é–±–∏–º–∞—è, —ç—Ç–∏ –≥–æ–¥—ã, –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ —Å —Ç–æ–±–æ–π - —Å–∫–∞–∑–∫–∞. –¢—ã —Å–∞–º—ã–π –ª—É—á—à–∏–π –ø–æ–¥–∞—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –º–æ–≥ –º–Ω–µ —Å–¥–µ–ª–∞—Ç—å —Ç—É–∞–ª–µ—Ç –ø–µ—Ä–≤–æ–≥–æ –º–æ–∫–∞üôè —è –±–µ–∑–º–µ—Ä–Ω–æ —Ä–∞–¥–∞, —á—Ç–æ –º–æ–≥—É —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≤–º–µ—Å—Ç–µ —Å —Ç–æ–±–æ–π —ç—Ç–æ—Ç –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –¥–µ–Ω—å - –¥–µ–Ω—å —Ç–≤–æ–µ–≥–æ —Ä–æ–∂–¥–µ–Ω–∏—è. –°—á–∏—Ç–∞—é, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–∞–∑–¥–Ω–∏–∫ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–º (–∫–æ–≥–¥–∞ —è —Å—Ç–∞–Ω—É –ø–æ–ª–Ω–æ–ø—Ä–∞–≤–Ω—ã–º –∏–º–ø–µ—Ä–∞—Ç–æ—Ä–æ–º, —è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–π–º—É—Å—å —ç—Ç–∏–º –≤–æ–ø—Ä–æ—Å–æ–º). –ü—Ä–µ–∫—Ä–∞—Å–Ω–æ –ø–æ–º–Ω—é —Ç–æ—Ç –¥–µ–Ω—å, –∫–æ–≥–¥–∞ –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ –¥–æ 5 —á–∞—Å–æ–≤ —É—Ç—Ä–∞, —ç—Ç–æ —Å–∞–º—ã–π —è—Ä–∫–∏–π –ø—Ä–∏–º–µ—Ä —Å–ª—É—á–∞—è, –µ—Å–ª–∏ –Ω–∏–∫—Ç–æ –Ω–µ —Å–∫–∞–∂–µ—Ç ¬´—É–∂–µ –ø–æ—Ä–∞¬ª, –ø–æ–ª–∞–≥–∞—é, –µ—Å–ª–∏ –±—ã –Ω–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Å–Ω–µ, –º—ã –±—ã –º–æ–≥–ª–∏ —Å–∏–¥–µ—Ç—å —Å—É—Ç–∫–∞–º–∏, –≤–µ–¥—å –º—ã –∏ –µ—Å—Ç—å –µ–¥–∏–Ω–∞—è –¥—É—à–∞, —Ä–∞–∑–ª–∏—Ç–∞—è –≤ —Ä–∞–∑–Ω—ã–µ —Ç–µ–ª–µ—Å–Ω—ã–µ –æ–±–æ–ª–æ—á–∫–∏, –Ω–∞–º —Å—É–∂–¥–µ–Ω–æ –±—ã–ª–æ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è –∏ —ç—Ç–æ —Å—É–¥—å–±–æ–Ω–æ—Å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ! –Ø –æ—á–µ–Ω—å —Ç–µ–±—è –ª—é–±–ª—é, –Ω–∞–¥–µ—é—Å—å, –Ω–∞—à —Ç–∞–Ω–¥–µ–º –ø—Ä–æ–∂–∏–≤–µ—Ç –≤–µ–∫–∞ –∏ —Ä–µ–∏–Ω–∫–∞—Ä–Ω–∏—Ä—É–µ—Ç –≤ –Ω–æ–≤—ã–µ –≤–∏–¥—ã. –¢—ã —Å–∞–º–∞—è –º–∏–ª–µ–π—à–∞—è –∏ –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞—è –¥–∞–º–∞ –Ω–∞ —ç—Ç–æ–º —Å–≤–µ—Ç–µ, —è —Ç–∞–∫ —Ç–µ–±—è –ª—é–±–ª—é —á—Ç–æ —â–∞—Å —É–º—Ä—É –ø–æ–∫–∞ –ø–µ—á–∞—Ç–∞—é, –±–æ–∂–µ –¥—É–¥–∑–∫–ø–∂—å–≤–∂—É–∂–∫–±–∞–¥–∞, —Ç—ã –º–æ—è –∑–∞–∂–∞–¥–ø–æ–∞–¥–∫–¥–∞–±–¥–ø–¥–øü•¥ü´£ü´£ü´∂üèªüòçüòçü•¥ü•¥üôèüôèü´∂üèªü•µü•µ',
        },
        {
          from: '–∞—Ä–∏—à–∞',
          message: '–∞–ª–∏—Å, –æ—á–µ–Ω—å —Ç–µ–±—è –ª—é–±–ª—é –∏ –≤—Å–µ–≥–¥–∞ —Ä—è–¥–æ–º! —Å–∏—è–π, –∑–≤–µ–∑–¥–æ—á–∫–∞!! <3',
          component: 'ArishaComponent',
        },
      ],
      vasObserver: null,
      vasFired: false,
      myConfetti: null,
    };
  },
  mounted() {
    // wait until DOM rendered
    this.$nextTick(() => {
      const el = this.$el.querySelector('.wishes__wrapper[data-from="VASSSSS"]');
      if (!el) return;

      // find the canvas inside the VASSSSS wrapper
      const canvas = el.querySelector('.wishes__canvas');
      if (canvas) {
        this.myConfetti = confetti.create(canvas, { resize: true });
      }

      this.vasObserver = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting && !this.vasFired) {
            this.vasFired = true;
            this.fireConfetti();
          }
        });
      }, { threshold: 0.5 });

      this.vasObserver.observe(el);
    });
  },
  beforeUnmount() {
    if (this.vasObserver) {
      this.vasObserver.disconnect();
      this.vasObserver = null;
    }
  },
  methods: {
    fireConfetti() {
      if (!this.myConfetti) return;
      this.myConfetti({
        // angle: 135,
        decay: 0.91,
        gravity: 0.5,
        startVelocity: 33,
        spread: 80,
        particleCount: 150,
        origin: { x: 0.5, y: 1 },
      });
    },
  },
};
</script>

<style lang="scss" scoped>
.wishes {
  padding: 20px;

  &__canvas {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 100vw;
    aspect-ratio: 1/2;
    // height: 100%;
    pointer-events: none;
    z-index: 1;
  }

  &__title {
    font-size: 2rem;
    margin-bottom: 0;
  }

  &__subtitle {
    font-size: 1.5rem;
    margin: 0;
  }

  &__wrapper {
    position: relative;
    width: 85%;
    text-align: left;
    padding: 10px;
    margin-bottom: 30px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);

    &:nth-of-type(even) {
      margin-left: calc(15% - 20px);
      text-align: right;
      background-color: #f9f9f9;
    }

    &:nth-of-type(1) {

      &::before {
        border-radius: 8px;
        background-image: url('/public/img/Absolute\ Cinema\ Meme.jpg');
        background-size: cover;
        /* replace $SELECTION_PLACEHOLDER$ with these lines inside the ::before */
        background-repeat: repeat-x;
        background-position: 0 0;
        animation: bg-slide 40s linear infinite;

        /* also add this keyframes block somewhere in the same <style> (outside the selector) */
        @keyframes bg-slide {
          from { background-position: 0 0; }
          to   { background-position: -1000px 0; } /* adjust -1000px or duration to control speed */
        }
        content: "";
        position: absolute;
        top: 0;
        left: 0px;
        width: 100%;
        height: 100%;
        opacity: 0.1;
        z-index: 0;
      }
    }
  }

  &__from {
    font-size: 1.4rem;
    font-weight: bold;
    margin: 0;
  }
  &__message {
    font-size: 1.2rem;
    margin: 0;
  }
}
</style>
